ATFile/ATImage Replacement Types
================================

This test tries to make sure the new, blob-based replacement types for
`ATFile` and `ATImage` can be properly created and edited.


Files
-----

Let's start with creating a "File" content item:

  >>> from StringIO import StringIO
  >>> self.setRoles('Editor')
  >>> browser = self.getBrowser()
  >>> browser.open(self.folder.absolute_url())

  >>> browser.getLink(url='createObject?type_name=File').click()
  >>> browser.url
  'http://nohost/plone/.../portal_factory/File/file.../edit'
  >>> browser.getControl(name='title').value = 'Foo'
  >>> control = browser.getControl(name='file_file')
  >>> control.filename = 'foo.pdf'
  >>> control.value = StringIO('%PDF-1.4 fake pdf...' + 'foo' * 1000)
  >>> browser.getControl('Save').click()

  >>> browser.url
  'http://nohost/plone/.../foo.pdf/view'
  >>> browser.contents
  '...Info...Changes saved...
   ...Foo...foo.pdf...PDF document,...2Kb...'

Now let's make sure we can also edit it:

  >>> browser.getLink('Edit').click()
  >>> browser.getControl(name='title').value = 'Foobar'
  >>> browser.getControl('Replace with new file').selected = True
  >>> control = browser.getControl(name='file_file')
  >>> control.filename = 'foobar.pdf'
  >>> control.value = StringIO('%PDF-1.4 fake pdf...' + 'foobar' * 1000)
  >>> browser.getControl('Save').click()

  >>> browser.url
  'http://nohost/plone/.../foo.pdf/view'
  >>> browser.contents
  '...Info...Changes saved...
   ...Foobar...foobar.pdf...PDF document,...5Kb...'

